{"paragraphs":[{"text":"%spark\nsc\nval hiveContext = new org.apache.spark.sql.hive.HiveContext(sc);\nhiveContext.sql(\"SHOW tables\").show()","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"lineNumbers":false,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053659_-440086857","id":"20190609-122413_1302661054","result":{"code":"SUCCESS","type":"TEXT","msg":"res174: org.apache.spark.SparkContext = org.apache.spark.SparkContext@5fb3a802\nhiveContext: org.apache.spark.sql.hive.HiveContext = org.apache.spark.sql.hive.HiveContext@24d90eb4\n+-------------+-----------+\n|    tableName|isTemporary|\n+-------------+-----------+\n|   avgmileage|      false|\n|drivermileage|      false|\n|   emp_salary|      false|\n|  geolocation|      false|\n|    sample_07|      false|\n|    sample_08|      false|\n| truckmileage|      false|\n|       trucks|      false|\n+-------------+-----------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2523"},{"text":"hiveContext.sql(\"DESCRIBE drivermileage\").show()","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"lineNumbers":false,"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053659_-440086857","id":"20190609-122413_228553413","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------+---------+-------+\n|col_name|data_type|comment|\n+--------+---------+-------+\n|driverid|   string|   null|\n|totmiles|   bigint|   null|\n+--------+---------+-------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2524"},{"text":"hiveContext.sql(\"select * from drivermileage limit 10\").show()","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053659_-440086857","id":"20190609-122413_1596451455","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------+--------+\n|driverid|totmiles|\n+--------+--------+\n|      A1|  628507|\n|     A10|  675377|\n|    A100|  634338|\n|     A11|  652452|\n|     A12|  668241|\n|     A13|  654319|\n|     A14|  649645|\n|     A15|  651036|\n|     A16|  638086|\n|     A17|  663821|\n+--------+--------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2525"},{"text":"hiveContext.sql(\"select * from geolocation limit 10\").show()","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorHide":false,"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053660_-442010602","id":"20190609-122413_898918567","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+--------+---------+---------+-----------+----------+----------+--------+---------+----------+\n|truckid|driverid|    event| latitude|  longitude|      city|     state|velocity|event_ind|idling_ind|\n+-------+--------+---------+---------+-----------+----------+----------+--------+---------+----------+\n|       |    null|     null|     null|       null|      null|      null|    null|     null|      null|\n|    A54|     A54|   normal|38.440467|-122.714431|Santa Rosa|California|      17|        0|         0|\n|    A20|     A20|   normal|36.977173|-121.899402|     Aptos|California|      27|        0|         0|\n|    A40|     A40|overspeed|37.957702| -121.29078|  Stockton|California|      77|        1|         0|\n|    A31|     A31|   normal|39.409608|-123.355566|   Willits|California|      22|        0|         0|\n|    A71|     A71|   normal|33.683947|-117.794694|    Irvine|California|      43|        0|         0|\n|    A50|     A50|   normal| 38.40765|-122.947713|Occidental|California|       0|        0|         1|\n|    A51|     A51|   normal|37.639097|-120.996878|   Modesto|California|       0|        0|         1|\n|    A19|     A19|   normal|37.962146|-122.345526| San Pablo|California|       0|        0|         1|\n|    A77|     A77|   normal|37.962146|-122.345526| San Pablo|California|      25|        0|         0|\n+-------+--------+---------+---------+-----------+----------+----------+--------+---------+----------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2526"},{"text":"val driver_occurance = hiveContext.sql(\"select driverid, count(driverid) occurance from geolocation where event !='normal' group by driverid\")\n\ndriver_occurance.registerTempTable(\"driver_occurances\")\nhiveContext.sql(\"SHOW tables\").show()\n","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053660_-442010602","id":"20190609-122413_576898924","result":{"code":"SUCCESS","type":"TEXT","msg":"driver_occurance: org.apache.spark.sql.DataFrame = [driverid: string, occurance: bigint]\n+-----------------+-----------+\n|        tableName|isTemporary|\n+-----------------+-----------+\n|driver_occurances|       true|\n|       avgmileage|      false|\n|    drivermileage|      false|\n|       emp_salary|      false|\n|      geolocation|      false|\n|        sample_07|      false|\n|        sample_08|      false|\n|     truckmileage|      false|\n|           trucks|      false|\n+-----------------+-----------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2527"},{"text":"val risk_factor = hiveContext.sql(\" SELECT a.driverid,a.occurance,b.totmiles,b.totmiles/a.occurance riskfactor from driver_occurances a JOIN drivermileage b where a.driverid = b.driverid\")\n\nrisk_factor.registerTempTable(\"risk_factor\")\nhiveContext.sql(\"SHOW tables\").show()","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053660_-442010602","id":"20190609-122413_51549463","result":{"code":"SUCCESS","type":"TEXT","msg":"risk_factor: org.apache.spark.sql.DataFrame = [driverid: string, occurance: bigint, totmiles: bigint, riskfactor: double]\n+-----------------+-----------+\n|        tableName|isTemporary|\n+-----------------+-----------+\n|driver_occurances|       true|\n|      risk_factor|       true|\n|       avgmileage|      false|\n|    drivermileage|      false|\n|       emp_salary|      false|\n|      geolocation|      false|\n|        sample_07|      false|\n|        sample_08|      false|\n|     truckmileage|      false|\n|           trucks|      false|\n+-----------------+-----------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2528"},{"text":"hiveContext.sql(\"SELECT * from risk_factor limit 15\").show()","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053660_-442010602","id":"20190609-122413_955914900","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------+---------+--------+------------------+\n|driverid|occurance|totmiles|        riskfactor|\n+--------+---------+--------+------------------+\n|     A18|        6|  656474|109412.33333333333|\n|      A7|        5|  653787|          130757.4|\n|      A8|        2|  653991|          326995.5|\n|      A9|        6|  665456|110909.33333333333|\n|     A80|        5|  681115|          136223.0|\n|     A81|        6|  645273|          107545.5|\n|     A82|        2|  631722|          315861.0|\n|     A83|        3|  653172|          217724.0|\n|     A84|        6|  651620|108603.33333333333|\n|     A85|        5|  635947|          127189.4|\n|     A86|        7|  629558| 89936.85714285714|\n|     A87|        6|  665023|110837.16666666667|\n|     A88|        5|  665021|          133004.2|\n|     A89|        2|  652530|          326265.0|\n|     A20|        5|  631496|          126299.2|\n+--------+---------+--------+------------------+\n\n"},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2529"},{"text":"risk_factor.rdd.coalesce(1).saveAsTextFile(\"/tmp/data/risk_factor\")","dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053660_-442010602","id":"20190609-122413_736561093","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2530"},{"dateUpdated":"Jun 9, 2019 12:24:13 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorHide":false,"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1560083053660_-442010602","id":"20190609-122413_1286548743","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 9, 2019 12:24:13 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2531"}],"name":"Compute Riskfactor with Spark","id":"2ECKW1546","angularObjects":{"2CNT96VC7":[],"2CNFR8NHH":[],"2CNRZBK5H":[],"2CPMMZ5VX":[],"2CMRPHAPU":[],"2CQ885ZXS":[],"2CPNFH883":[],"2CM3BU4VF":[],"2CQ6PK6KQ":[],"2CQJD3F1G":[],"2CPGNYW83":[],"2CN5S4Y6V":[],"2CQ8UK1UT":[]},"config":{"looknfeel":"default"},"info":{}}